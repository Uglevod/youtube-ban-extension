#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ XPI —Ñ–∞–π–ª–∞ –¥–ª—è Firefox

echo "ü¶ä –°–æ–∑–¥–∞–Ω–∏–µ XPI —Ñ–∞–π–ª–∞ –¥–ª—è Firefox"
echo "=================================="

# –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π XPI –µ—Å–ª–∏ –µ—Å—Ç—å
if [ -f "YBan-Firefox.xpi" ]; then
    echo "üóëÔ∏è  –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π XPI —Ñ–∞–π–ª..."
    rm YBan-Firefox.xpi
fi

# –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É –¥–ª—è —Å–±–æ—Ä–∫–∏
TEMP_DIR="temp_firefox"
if [ -d "$TEMP_DIR" ]; then
    rm -rf "$TEMP_DIR"
fi

echo "üìÅ –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É..."
mkdir "$TEMP_DIR"

# –ö–æ–ø–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
echo "üìã –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è..."

# –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–∞–Ω–∏—Ñ–µ—Å—Ç –¥–ª—è Firefox
cp manifest-firefox.json "$TEMP_DIR/manifest.json"
cp background.js "$TEMP_DIR/"
cp content.js "$TEMP_DIR/"
cp popup.html "$TEMP_DIR/"
cp popup.js "$TEMP_DIR/"
cp popup.css "$TEMP_DIR/"
cp styles.css "$TEMP_DIR/"

# –ü–∞–ø–∫–∞ —Å –∏–∫–æ–Ω–∫–∞–º–∏
cp -r icons "$TEMP_DIR/"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É XPI..."
ls -la "$TEMP_DIR/"

# –°–æ–∑–¥–∞–µ–º XPI –∞—Ä—Ö–∏–≤
echo "üì¶ –°–æ–∑–¥–∞–µ–º XPI –∞—Ä—Ö–∏–≤..."
cd "$TEMP_DIR"
zip -r ../YBan-Firefox.xpi . -x "*.DS_Store" "*.git*" "test_*" "*.md" "*.sh"
cd ..

# –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É
echo "üßπ –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã..."
rm -rf "$TEMP_DIR"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π XPI
echo "‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π XPI..."
echo "üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:"
ls -lh YBan-Firefox.xpi

echo "üìã –°–æ–¥–µ—Ä–∂–∏–º–æ–µ XPI:"
unzip -l YBan-Firefox.xpi

echo ""
echo "üéâ XPI —Ñ–∞–π–ª –¥–ª—è Firefox —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!"
echo "üìÅ –§–∞–π–ª: YBan-Firefox.xpi"
echo ""
echo "üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –≤ Firefox:"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ Firefox"
echo "2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ about:addons"
echo "3. –ù–∞–∂–º–∏—Ç–µ '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞'"
echo "4. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª YBan-Firefox.xpi"
echo "5. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É"
echo ""
echo "‚ö†Ô∏è  –ï—Å–ª–∏ Firefox –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç '—Ñ–∞–π–ª –ø–æ–≤—Ä–µ–∂–¥–µ–Ω':"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ about:config"
echo "2. –ù–∞–π–¥–∏—Ç–µ 'xpinstall.signatures.required'"
echo "3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ 'false'"
echo "4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Firefox"
echo "5. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–Ω–æ–≤–∞"
echo ""
echo "üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± (–≤—Ä–µ–º–µ–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞):"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ about:debugging"
echo "2. –ù–∞–∂–º–∏—Ç–µ '–≠—Ç–æ—Ç Firefox'"
echo "3. –ù–∞–∂–º–∏—Ç–µ '–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ'"
echo "4. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª manifest.json –∏–∑ –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞"
echo ""
echo "üìù –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Firefox –≤–µ—Ä—Å–∏–∏:"
echo "‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞–Ω–∏—Ñ–µ—Å—Ç –¥–ª—è Firefox"
echo "‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Firefox 78+"
echo "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–º–µ—Ä–æ–≤"
echo "‚úÖ Content Security Policy"
echo "‚úÖ Web Accessible Resources"
